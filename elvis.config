[{elvis, [
    {config, [
        %% ---- Erlang source files ----
        #{dirs    => ["apps/*/src"],
          filter  => "*.erl",
          ruleset => erl_files,
          rules   => [
              %% Record types in -spec annotations are informative and
              %% appropriate for a project with a shared bc_types.hrl.
              {elvis_style, no_spec_with_records, disable},

              %% Behaviour callbacks are intentionally invoked via dynamic
              %% dispatch throughout: ProvMod:init/1, Mod:execute/3, etc.
              %% This is idiomatic OTP behaviour usage.
              {elvis_style, no_invalid_dynamic_calls, disable},

              %% 'catch' expressions are used intentionally in a few places:
              %%   - port_close in terminate (suppress already-closed errors)
              %%   - timeout suppression in optional operations
              {elvis_style, no_catch_expressions, disable},

              %% io:format calls in bc_channel_tui are the terminal I/O
              %% mechanism, not debug instrumentation. All other modules
              %% use OTP logger.
              {elvis_style, no_debug_call,
               #{ignore => [bc_channel_tui]}},

              %% MCP JSON-RPC 2.0 protocol mandates camelCase field names
              %% (protocolVersion, clientInfo). These are wire-format atoms
              %% that cannot be renamed.
              {elvis_style, atom_naming_convention, disable}
          ]},

        %% ---- Header files ----
        #{dirs    => ["apps/*/include"],
          filter  => "*.hrl",
          ruleset => hrl_files,
          rules   => [
              %% bc_types.hrl is the canonical type definition file for the
              %% umbrella project. Defining -type here is correct practice
              %% for a shared include file used across six OTP apps.
              {elvis_style, no_types, disable}
          ]},

        %% ---- Test files (relaxed: allow records in specs) ----
        #{dirs    => ["apps/*/test"],
          filter  => "*.erl",
          ruleset => erl_files,
          rules   => [
              {elvis_style, no_spec_with_records, disable},
              {elvis_style, no_invalid_dynamic_calls, disable},
              {elvis_style, no_catch_expressions, disable},
              {elvis_style, no_debug_call, disable},
              {elvis_style, atom_naming_convention, disable}
          ]},

        %% ---- .gitignore ----
        #{dirs   => ["."],
          filter => ".gitignore",
          ruleset => gitignore}
    ]}
]}].
